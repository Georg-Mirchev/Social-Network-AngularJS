<div ng-if="post.totalCommentsCount >= 0" id="comments" ng-controller="CommentsController">
    <a href="" ng-if="post.totalCommentsCount - post.comments.length > 0" ng-hide="isHidden"
       ng-click="showAllComments(post); isHidden = true">
        Show All {{post.totalCommentsCount}} Comments</a>

    <div class="comment" ng-repeat="comment in post.comments | orderBy: 'id'">

        <button ng-if="comment.author.username == authService.getCurrentUser().userName ||
        post.author.username == authService.getCurrentUser().userName" ng-click="deleteComment(post, comment)">Delete</button>

        <button ng-if="comment.author.username == authService.getCurrentUser().userName" ng-click="comment.editing = true"
                ng-hide="comment.editing">Edit</button>

        <a ng-controller="HoverController" href="#/users/{{comment.author.username}}"
           hover-intent="hoverBox(comment.author.username)"
           ns-popover ns-popover-template="templates/hoverBox.html"
             ns-popover-trigger="mouseenter" ns-popover-timeout="0.5" ns-popover-placement="bottom">
            <img ng-src="{{comment.author.profileImageData || 'resources/defaultProfilePicture.jpg'}}"/>
            {{comment.author.name}}: </a>

        <div ng-hide="comment.editing">{{comment.commentContent}}</div>
        <div ng-show="comment.editing">
            <form ng-submit="editComment(post, comment)">
                <textarea ng-model="comment.commentContent" cols="30" rows="3">
                    comment.commentContent
                </textarea>
                <button type="submit" ng-click="comment.editing = false">Save</button>
                <a href="" ng-click="comment.editing = false">Cancel</a>
            </form>
        </div>

        <div>{{dateFromNow(comment.date)}}</div>

        <div ng-if="isFriend || post.author.isFriend || post.wallOwner.isFriend">
            <a ng-if="!comment.liked" href="" ng-click="likeComment(post, comment)">Like</a>
            <a ng-if="comment.liked" href="" ng-click="unlikeComment(post, comment)">Unlike</a>
        </div>

        <div>Likes: {{comment.likesCount}}</div>
    </div>

    <div ng-if="isFriend || post.author.isFriend || post.wallOwner.isFriend">
        <form name="addCommentForm" ng-submit="addComment(post, commentData)">
            <textarea class="commentContent" ng-model="commentData.commentContent" minlength="2" required></textarea>
            <button type="submit">Comment</button>
        </form>
    </div>
</div>